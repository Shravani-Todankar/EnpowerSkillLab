<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Details</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="sidebar.css">
    <link rel="stylesheet" href="header.css">
    <script src="sidebar.js"></script>
    <script src="header.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: #f9fafb;
            color: #1f2937;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        .school-profile {
            padding: 1.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #6b7280;
            text-decoration: none;
            margin-bottom: 1.5rem;
            transition: color 0.2s;
        }

        .back-link:hover {
            color: #6B21A8;
        }

        .profile-header {
            display: flex;
            align-items: flex-start;
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 2rem;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }

        .school-logo-placeholder {
            width: 120px;
            height: 120px;
            border-radius: 12px;
            background: linear-gradient(135deg, #7E22CE, #6B21A8);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 2.5rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .profile-info {
            flex: 1;
            min-width: 250px;
        }

        .profile-info h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
        }

        .profile-info .school-id {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .control-pill {
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.25rem 0.6rem;
            display: inline-flex;
        }

        .status-active {
            background-color: #d1fae5;
            color: #166534;
        }

        .status-inactive {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .info-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
        }

        .info-card-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .info-card-header h2 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
        }

        .info-card-header .material-symbols-outlined {
            color: #6B21A8;
            font-size: 24px;
        }

        .info-card-body {
            padding: 1.5rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .info-value {
            font-size: 0.95rem;
            color: #1f2937;
            font-weight: 500;
        }

        #sidebar-container:empty,
        #header-container:empty {
            opacity: 0;
            visibility: hidden;
        }

        #sidebar-container.loaded,
        #header-container.loaded {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.2s ease-in;
        }
    </style>
</head>

<body>
    <div class="dashboard-container">
        <div id="sidebar-container"></div>
        <main class="main-content">
            <div id="header-container"></div>
            <div class="school-profile">
                <a href="school-list.html" class="back-link" onclick="window.history.back(); return false;">
                    <span class="material-symbols-outlined">arrow_back</span>
                    Back to School List
                </a>

                <div class="profile-header">
                    <div class="school-logo-placeholder">SCH</div>
                    <div class="profile-info">
                        <h1 id="schoolName">School Name</h1>
                        <p class="school-id" id="schoolIdDisplay"><strong>School ID:</strong> Loading...</p>
                        <span class="control-pill status-active" id="statusPill">Active</span>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <span class="material-symbols-outlined">school</span>
                        <h2>School Information</h2>
                    </div>
                    <div class="info-card-body">
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">School Name</span>
                                <span class="info-value" id="infoSchoolName">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">School Type</span>
                                <span class="info-value" id="schoolType">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Established Year</span>
                                <span class="info-value" id="establishedYear">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Affiliation Board</span>
                                <span class="info-value" id="affiliationBoard">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Principal Name</span>
                                <span class="info-value" id="principalName">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Partnership Date</span>
                                <span class="info-value" id="partnershipDate">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <span class="material-symbols-outlined">contact_mail</span>
                        <h2>Contact Information</h2>
                    </div>
                    <div class="info-card-body">
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Email Address</span>
                                <span class="info-value" id="emailAddress">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Phone Number</span>
                                <span class="info-value" id="phoneNumber">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Alternate Phone</span>
                                <span class="info-value" id="alternatePhone">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Website</span>
                                <span class="info-value" id="website">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <span class="material-symbols-outlined">location_on</span>
                        <h2>Location Details</h2>
                    </div>
                    <div class="info-card-body">
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">City</span>
                                <span class="info-value" id="city">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">State/Province</span>
                                <span class="info-value" id="state">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Country</span>
                                <span class="info-value" id="country">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Postal Code</span>
                                <span class="info-value" id="postalCode">-</span>
                            </div>
                            <div class="info-item" style="grid-column: 1 / -1;">
                                <span class="info-label">Full Address</span>
                                <span class="info-value" id="fullAddress">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-header">
                        <span class="material-symbols-outlined">groups</span>
                        <h2>Student & Staff Information</h2>
                    </div>
                    <div class="info-card-body">
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Number of Students</span>
                                <span class="info-value" id="numberOfStudents">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Number of Teachers</span>
                                <span class="info-value" id="numberOfTeachers">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Number of Staff</span>
                                <span class="info-value" id="numberOfStaff">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            Promise.all([
                fetch('sidebar.html').then(response => response.text()),
                fetch('header.html').then(response => response.text())
            ]).then(([sidebarHTML, headerHTML]) => {
                document.getElementById('sidebar-container').innerHTML = sidebarHTML;
                document.getElementById('header-container').innerHTML = headerHTML;
                if (typeof initializeHeader === 'function') {
                    initializeHeader();
                }
                setTimeout(() => {
                    setActiveMenuItem();
                }, 200);
            });

            populateSchoolData();
        });

        function setActiveMenuItem() {
            const navSchoolList = document.getElementById('nav-school-list');
            if (navSchoolList) {
                navSchoolList.classList.add('active');
            }
        }

        function populateSchoolData() {
            const urlParams = new URLSearchParams(window.location.search);
            const schoolId = urlParams.get('id');
            const schoolNameParam = urlParams.get('name');
            const location = urlParams.get('location');
            const contact = urlParams.get('contact');
            const students = urlParams.get('students');
            const status = urlParams.get('status');

            if (schoolNameParam) {
                document.title = `${schoolNameParam} - School Details`;
                document.getElementById('schoolName').textContent = schoolNameParam;
                document.getElementById('infoSchoolName').textContent = schoolNameParam;

                const nameParts = schoolNameParam.split(' ');
                const initials = nameParts.map(part => part.charAt(0).toUpperCase()).join('');
                document.querySelector('.school-logo-placeholder').textContent = initials.substring(0, 3);
            }

            if (schoolId) {
                document.getElementById('schoolIdDisplay').innerHTML = `<strong>School ID:</strong> ${schoolId}`;
            }

            if (location) {
                document.getElementById('city').textContent = location;
            }

            if (contact) {
                document.getElementById('emailAddress').textContent = contact;
            }

            if (students) {
                document.getElementById('numberOfStudents').textContent = students;
            }

            if (status) {
                const statusPill = document.getElementById('statusPill');
                if (statusPill) {
                    statusPill.classList.remove('status-active', 'status-inactive');
                    if (status === 'Active') {
                        statusPill.classList.add('status-active');
                    } else if (status === 'Inactive') {
                        statusPill.classList.add('status-inactive');
                    }
                    statusPill.textContent = status;
                }
            }

            // Load additional data from localStorage if available
            const schools = JSON.parse(localStorage.getItem('schools') || '{}');
            if (schoolId && schools[schoolId]) {
                const school = schools[schoolId];

                if (school.schoolType) document.getElementById('schoolType').textContent = school.schoolType;
                if (school.establishedYear) document.getElementById('establishedYear').textContent = school.establishedYear;
                if (school.affiliationBoard) document.getElementById('affiliationBoard').textContent = school.affiliationBoard;
                if (school.principalName) document.getElementById('principalName').textContent = school.principalName;
                if (school.partnershipDate) document.getElementById('partnershipDate').textContent = school.partnershipDate;
                if (school.phoneNumber) document.getElementById('phoneNumber').textContent = school.phoneNumber;
                if (school.alternatePhone) document.getElementById('alternatePhone').textContent = school.alternatePhone;
                if (school.website) document.getElementById('website').textContent = school.website;
                if (school.state) document.getElementById('state').textContent = school.state;
                if (school.country) document.getElementById('country').textContent = school.country;
                if (school.postalCode) document.getElementById('postalCode').textContent = school.postalCode;
                if (school.fullAddress) document.getElementById('fullAddress').textContent = school.fullAddress;
                if (school.numberOfTeachers) document.getElementById('numberOfTeachers').textContent = school.numberOfTeachers;
                if (school.numberOfStaff) document.getElementById('numberOfStaff').textContent = school.numberOfStaff;
            }
        }
    </script>
</body>
</html>
