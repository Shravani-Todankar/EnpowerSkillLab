<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Student Dashboard - Enpower Skill Lab</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="student-dashboard.css">

    <!-- Header JS -->
    <script src="header.js"></script>
    <!-- Sidebar JS -->
    <script src="sidebar.js"></script>

    <style>
        /* Prevent FOUC - hide containers until loaded */
        #sidebar-container:empty,
        #header-container:empty {
            opacity: 0;
            visibility: hidden;
        }

        #sidebar-container.loaded,
        #header-container.loaded {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.2s ease-in;
        }
    </style>
</head>

<body>
    <div class="dashboard-container">
        <!-- Include Sidebar Component -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Include Header Component -->
            <div id="header-container"></div>

            <!-- Content -->
            <div class="content-wrapper">
                <!-- Sidebar Column -->
                <div class="sidebar-column">
                    <div class="card">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <img alt="Student avatar"
                                    src="https://lh3.googleusercontent.com/aida-public/AB6AXuDcIJndixMoK4d7aUwjLNvUwGvQtwhoZp4zrBYHVGp_UbVoliCXsHU6Px_N4mBzfACwz3nJ2LpxL3Ws-XZbgIozb_cRIXJSxDOB2E2kzyb17yyplKyWeyRDLc-fj9vfq0_snyn1Sph7cn21sgjjyZvpAiuZIPF2nmJa_WqFLafr9reOBS1SXMU7f3XdOpsHE_wug6-xsGVmdXkOvYSvf5KdZDEIYmVUz-mfuhm5JroeQp4NP7_6_8NM9c77yCwB6A0DQSdxijqgA9Y" />
                            </div>
                            <h2 class="profile-name">kunal</h2>
                        </div>
                        <div class="profile-details">
                            <div class="detail-row">
                                <span class="detail-label">Registration No</span>
                                <span class="detail-value blue">210903 <span
                                        class="material-symbols-outlined align-middle">arrow_forward</span></span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Institute</span>
                                <span class="detail-value">Delhi Public School</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Date of Admission</span>
                                <span class="detail-value">21 November, 2025</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Class</span>
                                <span class="detail-value blue">9 <span
                                        class="material-symbols-outlined align-middle">arrow_forward</span></span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Family</span>
                                <span class="detail-value blue"><span
                                        class="material-symbols-outlined align-middle">arrow_forward</span></span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Discount in Fee</span>
                                <span class="detail-value green">20 % <span
                                        class="material-symbols-outlined align-middle">arrow_forward</span></span>
                            </div>
                            <!-- <div class="detail-divider"></div>
                            <div class="info-list">
                                <p>Date Of Birth <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Gender <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Any Identification Mark? <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Blood Group <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Disease if Any? <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Student Birth Form ID / NIC <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Cast <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Previous School <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                <p>Previous ID / Board Roll No <span class="material-symbols-outlined align-middle">arrow_forward</span></p>
                            </div> -->
                        </div>
                    </div>

                     <div class="stats-cards-container">
                        <div class="card stats-overview-card stats-main-card">
                            <div class="stats-card-glow"></div>
                            <div class="stats-overview-header">
                                <div class="stats-content">
                                    <h3 class="stats-label">
                                        <span class="material-symbols-outlined stats-label-icon">school</span>
                                        Total Registered Students
                                    </h3>
                                    <div class="stats-count-wrapper">
                                        <p class="stats-count" id="studentCount">0</p>
                                        <span class="stats-count-plus">+</span>
                                    </div>
                                    <p class="stats-subtitle">Active learners in the system</p>
                                </div>
                            </div>
                            <div class="stats-badge">
                                <span class="material-symbols-outlined">trending_up</span>
                                <span>All Active Students</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quiz Widget -->
                    <div class="card quiz-card">
                        <div class="quiz-header">
                            <div class="quiz-icon-wrapper">
                                <span class="material-symbols-outlined quiz-icon">quiz</span>
                            </div>
                            <div class="quiz-info">
                                <h4 class="quiz-title">Test Your Knowledge!</h4>
                                <p class="quiz-subtitle">Complete today's quiz and earn XP</p>
                            </div>
                        </div>

                        <div class="quiz-stats">
                            <div class="quiz-stat-item">
                                <span class="material-symbols-outlined quiz-stat-icon">verified</span>
                                <div>
                                    <p class="quiz-stat-value">15/20</p>
                                    <p class="quiz-stat-label">Completed</p>
                                </div>
                            </div>
                            <div class="quiz-stat-item">
                                <span class="material-symbols-outlined quiz-stat-icon">stars</span>
                                <div>
                                    <p class="quiz-stat-value">750 XP</p>
                                    <p class="quiz-stat-label">Total Earned</p>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-current">
                            <div class="quiz-current-header">
                                <h5 class="quiz-current-title">Today's Quiz</h5>
                                <span class="quiz-badge new">NEW</span>
                            </div>
                            <p class="quiz-current-subject">
                                <span class="material-symbols-outlined">subject</span>
                                Mathematics - Algebra
                            </p>
                            <div class="quiz-progress-wrapper">
                                <div class="quiz-progress-info">
                                    <span class="quiz-questions-count">10 Questions</span>
                                    <span class="quiz-time">
                                        <span class="material-symbols-outlined">timer</span>
                                        15 min
                                    </span>
                                </div>
                                <div class="quiz-reward">
                                    <span class="material-symbols-outlined">workspace_premium</span>
                                    +50 XP
                                </div>
                            </div>
                        </div>

                        <button class="quiz-start-btn">
                            <span class="material-symbols-outlined">play_arrow</span>
                            Start Quiz
                        </button>
                    </div>
                </div>

                <!-- Main Column -->
                <div class="main-column">
                     <!-- Gamification Card -->
                    <div class="card gamification-card">
                        <h3 class="gamification-title">Journey Progress</h3>

                        <!-- XP Points Section -->
                        <div class="xp-section">
                            <div class="xp-header">
                                <span class="material-symbols-outlined xp-icon">stars</span>
                                <div>
                                    <p class="xp-label">Experience Points</p>
                                    <p class="xp-value">2,450 XP <span class="xp-label">level 5</span></p>
                                </div>
                            </div>
                            <div class="xp-progress">
                                <div class="xp-progress-bar">
                                    <div class="xp-progress-fill" style="width: 65%;"></div>
                                </div>
                                <p class="xp-progress-text">1,550 XP to Level 6</p>
                            </div>
                        </div>

                        <!-- Streak Section -->
                        <div class="streak-section">
                            <div class="streak-item">
                                <span class="material-symbols-outlined streak-icon fire">local_fire_department</span>
                                <div>
                                    <p class="streak-value">7 Days</p>
                                    <p class="streak-label">Current Streak</p>
                                </div>
                            </div>
                            <div class="streak-item">
                                <span class="material-symbols-outlined streak-icon trophy">emoji_events</span>
                                <div>
                                    <p class="streak-value">21 Days</p>
                                    <p class="streak-label">Best Streak</p>
                                </div>
                            </div>
                        </div>

                        <!-- Badges Section -->
                        <div class="badges-section">
                            <div class="badges-header">
                                <h4 class="badges-title">Recent Badges</h4>
                                <a href="badges.html" class="badges-link">View All <span
                                        class="material-symbols-outlined align-middle">arrow_forward</span></a>
                            </div>
                            <div class="badges-grid">
                                <div class="badge-item">
                                    <span class="material-symbols-outlined badge-icon gold">military_tech</span>
                                    <p class="badge-name">Top Performer</p>
                                </div>
                                <div class="badge-item">
                                    <span class="material-symbols-outlined badge-icon silver">school</span>
                                    <p class="badge-name">Quick Learner</p>
                                </div>
                                <div class="badge-item">
                                    <span class="material-symbols-outlined badge-icon bronze">workspace_premium</span>
                                    <p class="badge-name">Consistent</p>
                                </div>
                                <div class="badge-item locked">
                                    <span class="material-symbols-outlined badge-icon">lock</span>
                                    <p class="badge-name">Mystery</p>
                                </div>
                            </div>
                        </div>

                        <!-- Leaderboard Section -->
                        <div class="leaderboard-section">
                            <div class="leaderboard-header">
                                <h4 class="leaderboard-title">Leaderboard Position</h4>
                                <span class="leaderboard-period">This Month</span>
                            </div>
                            <div class="leaderboard-rank">
                                <div class="rank-badge">
                                    <span class="material-symbols-outlined rank-icon">leaderboard</span>
                                    <span class="rank-number">#12</span>
                                </div>
                                <div class="rank-info">
                                    <p class="rank-text">Out of 150 students</p>
                                    <p class="rank-change positive">
                                        <span class="material-symbols-outlined">trending_up</span>
                                        +3 from last month
                                    </p>
                                </div>
                            </div>
                            <a href="leaderboard.html" class="leaderboard-cta">
                                View Full Leaderboard
                                <span class="material-symbols-outlined">arrow_forward</span>
                            </a>
                        </div>
                    </div>

                    <!-- Reports Grid -->
                    <div class="reports-grid">
                        <!-- Attendance Report -->
                        <div>
                            <a href="attendance.html" class="report-link">
                                <div class="report-header">
                                    <span class="report-number">1</span>
                                    <h3 class="report-title">Attendance Report</h3>
                                </div>
                            </a>
                            <div class="card">
                                <div class="legend">
                                    <span class="legend-item">
                                        <span class="legend-dot blue"></span>P
                                    </span>
                                    <span class="legend-item">
                                        <span class="legend-dot red"></span>A
                                    </span>
                                </div>
                                <div class="charts-wrapper">
                                    <div class="chart-container">
                                        <svg class="rotate-90" width="120" height="120">
                                            <circle cx="60" cy="60" fill="none" r="52" stroke="#fecaca"
                                                stroke-width="9"></circle>
                                            <circle cx="60" cy="60" fill="none" r="52" stroke="#ef4444"
                                                stroke-dasharray="326.7" stroke-dashoffset="326.7" stroke-width="9">
                                            </circle>
                                        </svg>
                                        <div class="chart-label">
                                            <span class="chart-percent">0%</span>
                                            <span class="chart-text">Overall</span>
                                        </div>
                                    </div>
                                    <div class="chart-container">
                                        <svg class="rotate-90" width="120" height="120">
                                            <circle cx="60" cy="60" fill="none" r="52" stroke="#fecaca"
                                                stroke-width="9"></circle>
                                            <circle cx="60" cy="60" fill="none" r="52" stroke="#ef4444"
                                                stroke-dasharray="326.7" stroke-dashoffset="326.7" stroke-width="9">
                                            </circle>
                                        </svg>
                                        <div class="chart-label">
                                            <span class="chart-percent">0%</span>
                                            <span class="chart-text">Nov 2025</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="stats-grid stud-dash-grid">
                                    <div class="stat-card blue stud1">
                                        <p class="stat-label blue">PRESENTS</p>
                                        <p class="stat-value blue">0</p>
                                        <p class="stat-period blue">This Month <span
                                                class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                    </div>
                                    <div class="stat-card red stud2">
                                        <p class="stat-label red">ABSENTS</p>
                                        <p class="stat-value red">0</p>
                                        <p class="stat-period red">This Month <span
                                                class="material-symbols-outlined align-middle">arrow_forward</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Event Calendar -->
                        <div>
                            <a href="event-calendar.html" class="report-link">
                                <div class="report-header">
                                    <span class="report-number">2</span>
                                    <h3 class="report-title">Event Calendar</h3>
                                </div>
                            </a>
                            <div class="card calendar-card">
                                <!-- Calendar Header -->
                                <div class="calendar-header">
                                    <div class="calendar-month">
                                        <button class="calendar-nav-btn" id="prevMonth">
                                            <span class="material-symbols-outlined">chevron_left</span>
                                        </button>
                                        <h4 class="calendar-month-title">November 2025</h4>
                                        <button class="calendar-nav-btn" id="nextMonth">
                                            <span class="material-symbols-outlined">chevron_right</span>
                                        </button>
                                    </div>
                                    <button class="calendar-view-btn">
                                        <span class="material-symbols-outlined">event</span>
                                        View Full Calendar
                                    </button>
                                </div>

                                <!-- Upcoming Events List -->
                                <div class="events-list">
                                    <h5 class="events-title">Upcoming Events</h5>

                                    <div class="event-item">
                                        <div class="event-date">
                                            <span class="event-day">22</span>
                                            <span class="event-month">NOV</span>
                                        </div>
                                        <div class="event-details">
                                            <h6 class="event-name">Science Fair Competition</h6>
                                            <p class="event-time">
                                                <span class="material-symbols-outlined">schedule</span>
                                                10:00 AM - 2:00 PM
                                            </p>
                                            <p class="event-location">
                                                <span class="material-symbols-outlined">location_on</span>
                                                School Auditorium
                                            </p>
                                        </div>
                                        <span class="event-badge academic">Academic</span>
                                    </div>

                                    <div class="event-item">
                                        <div class="event-date">
                                            <span class="event-day">25</span>
                                            <span class="event-month">NOV</span>
                                        </div>
                                        <div class="event-details">
                                            <h6 class="event-name">Parent-Teacher Meeting</h6>
                                            <p class="event-time">
                                                <span class="material-symbols-outlined">schedule</span>
                                                9:00 AM - 12:00 PM
                                            </p>
                                            <p class="event-location">
                                                <span class="material-symbols-outlined">location_on</span>
                                                Class 9 Rooms
                                            </p>
                                        </div>
                                        <span class="event-badge meeting">Meeting</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Featured Newsletter -->
                        <div>
                            <a href="newsletter.html" class="report-link">
                                <div class="report-header">
                                    <span class="report-number">3</span>
                                    <h3 class="report-title">Featured Newsletter</h3>
                                </div>
                            </a>
                            <div class="card newsletter-card">
                                <div class="newsletter-featured-badge">
                                    <span class="material-symbols-outlined">auto_awesome</span>
                                    Featured
                                </div>

                                <div class="newsletter-header">
                                    <div class="newsletter-icon-wrapper">
                                        <span class="material-symbols-outlined newsletter-icon">mail</span>
                                    </div>
                                    <div class="newsletter-meta">
                                        <span class="newsletter-date">December 9, 2025</span>
                                        <span class="newsletter-category">Monthly Edition</span>
                                    </div>
                                </div>

                                <h4 class="newsletter-title">Student Success Stories</h4>

                                <button class="newsletter-read-btn">
                                    Read Newsletter
                                    <span class="material-symbols-outlined">arrow_forward</span>
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Load Sidebar and Header Components
        Promise.all([
            fetch('sidebar.html').then(response => response.text()),
            fetch('header.html').then(response => response.text())
        ]).then(([sidebarHTML, headerHTML]) => {
            // Insert both components
            document.getElementById('sidebar-container').innerHTML = sidebarHTML;
            document.getElementById('header-container').innerHTML = headerHTML;

            // Initialize both sidebar and header functionality after components are loaded
            // Use setTimeout to ensure DOM has parsed the inserted HTML
            setTimeout(() => {
                initializeSidebar();
                // Call header initialization directly instead of relying on DOMContentLoaded
                if (typeof initializeHeader === 'function') {
                    initializeHeader();
                }

                // Mark containers as loaded to make them visible with smooth transition
                document.getElementById('sidebar-container').classList.add('loaded');
                document.getElementById('header-container').classList.add('loaded');
            }, 0);
        });

        function initializeSidebar() {
            const menuToggle = document.getElementById('menuToggle');
            const closeSidebar = document.getElementById('closeSidebar');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');

            function toggleSidebar() {
                if (window.innerWidth >= 1024) {
                    sidebar.classList.toggle('collapsed');
                } else {
                    sidebar.classList.add('active');
                    sidebarOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
            }

            function closeSidebarFunc() {
                sidebar.classList.remove('active');
                sidebarOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }

            menuToggle.addEventListener('click', toggleSidebar);
            closeSidebar.addEventListener('click', closeSidebarFunc);
            sidebarOverlay.addEventListener('click', closeSidebarFunc);

            const sidebarLinks = sidebar.querySelectorAll('a');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth < 1024) {
                        closeSidebarFunc();
                    }
                });
            });

            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1024) {
                    closeSidebarFunc();
                } else {
                    sidebar.classList.remove('collapsed');
                }
            });

            // Set active link based on current page
            setActiveLink();
        }

        function setActiveLink() {
            const currentPage = window.location.pathname.split('/').pop();
            const navLinks = {
                'student-dashboard.html': 'nav-dashboard',
                'attendance.html': 'nav-attendance',
                'lms.html': 'nav-lms',
                'leaderboard.html': 'nav-leaderboard',
                'assessment.html': 'nav-assessment',
                'reports.html': 'nav-reports',
                'badges.html': 'nav-badges',
                'event-calendar.html': 'nav-event-calendar',
                'newsletter.html': 'nav-newsletter',
                'announcements.html': 'nav-announcements'
            };

            const sidebar = document.getElementById('sidebar');
            const sidebarLinks = sidebar.querySelectorAll('a');

            // Remove all active classes
            sidebarLinks.forEach(link => link.classList.remove('active'));

            // Add active class to current page link
            if (navLinks[currentPage]) {
                const activeLink = document.getElementById(navLinks[currentPage]);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }
        }

        // Animated counter function
        function animateCounter(element, target, duration = 2000) {
            const start = 0;
            const increment = target / (duration / 16); // 60 FPS
            let current = start;

            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = target.toLocaleString();
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current).toLocaleString();
                }
            }, 16);
        }

        // Fetch and display student count with animation
        async function fetchStudentCount() {
            try {
                // Replace this URL with your actual API endpoint
                const response = await fetch('/api/students/count');
                const data = await response.json();

                // Animate the main student count
                animateCounter(
                    document.getElementById('studentCount'),
                    data.totalStudents || 150,
                    2000
                );

                // Animate new students count
                animateCounter(
                    document.getElementById('newStudents'),
                    data.newThisMonth || 12,
                    1500
                );

                // Animate active students count
                animateCounter(
                    document.getElementById('activeStudents'),
                    data.activeToday || 89,
                    1800
                );
            } catch (error) {
                console.error('Error fetching student count:', error);
                // Fallback to demo data with animation
                animateCounter(document.getElementById('studentCount'), 150, 2000);
                animateCounter(document.getElementById('newStudents'), 12, 1500);
                animateCounter(document.getElementById('activeStudents'), 89, 1800);
            }
        }

        // Call the function when page loads
        fetchStudentCount();
    </script>
</body>

</html>